<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
    <script src="./jquery-1.11.1.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">


    <script>

        var hdc;
        var element;
        var data = {
            'A/4': '<div>\n    <span>Kezdés</span>\n    <span>befejezés</span>\n</div>\n<div>\n    <span>16:00</span>\n    <span>22:00</span>\n</div>',
            'A/3': '<div><table>\n' +
                '  <tr>\n' +
                '    <th>Ásványkiállítás</th>\n' +
                '    <th>A/3 épület III. emelet</th>\n' +
                '    <th>17.00-22.00</th>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Tanbánya  bemutató</td>\n' +
                '    <td>Maria Anders</td>\n' +
                '    <td>Germany</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Centro comercial Moctezuma</td>\n' +
                '    <td>Francisco Chang</td>\n' +
                '    <td>Mexico</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Ernst Handel</td>\n' +
                '    <td>Roland Mendel</td>\n' +
                '    <td>Austria</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Island Trading</td>\n' +
                '    <td>Helen Bennett</td>\n' +
                '    <td>UK</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Laughing Bacchus Winecellars</td>\n' +
                '    <td>Yoshi Tannamuri</td>\n' +
                '    <td>Canada</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Magazzini Alimentari Riuniti</td>\n' +
                '    <td>Giovanni Rovelli</td>\n' +
                '    <td>Italy</td>\n' +
                '  </tr>\n' +
                '</table>' +
                '</div>',

            'Diszaula': '<div>' +
                '<table class="table table-responsive table-">\n' +
                '  <tr>\n' +
                '    <th>Előadás</th>\n' +
                '    <th>Helyszín</th>\n' +
                '    <th>Időpont</th>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Ásványsimogató</td>\n' +
                '    <td>Díszaula</td>\n' +
                '    <td>17.00-22.00</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Miből lesz a földtani cserebogár?</td>\n' +
                '    <td>Díszaula</td>\n' +
                '    <td>17.00-22.00</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Jó és rossz műanyag</td>\n' +
                '    <td>Díszaula</td>\n' +
                '    <td>17.00-22.00</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Larina? Tesla? Tik-tok? Tudomány!</td>\n' +
                '    <td>Díszaula</td>\n' +
                '    <td>17.00-22.00</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>AI Showroom</td>\n' +
                '    <td>Díszaula</td>\n' +
                '    <td>17.00-22.00</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>evosoft Hungary Kft. „a világ logikáját mi alakítjuk szoftverré”</td>\n' +
                '    <td>Díszaula</td>\n' +
                '    <td>17.00-22.00</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Lássuk a hőt!</td>\n' +
                '    <td>Díszaula</td>\n' +
                '    <td>18.30-21.30</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Megújuló energiák asztala</td>\n' +
                '    <td>Díszaula</td>\n' +
                '    <td>18.30-21.30</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Pörgess és nyerj!</td>\n' +
                '    <td>Díszaula</td>\n' +
                '    <td>17.00-22.00</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Teszteld a jogi tudásod! - fejtörő</td>\n' +
                '    <td>Díszaula</td>\n' +
                '    <td>17.00-22.00</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td> Ne válj áldozattá!</td>\n' +
                '    <td>Díszaula</td>\n' +
                '    <td>17.00-21.00</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Testünk titkai; Függőségeink</td>\n' +
                '    <td>Díszaula</td>\n' +
                '    <td>17.00-22.00</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Sebkészítés, sebkötözés. Újraélesztés.</td>\n' +
                '    <td>Díszaula</td>\n' +
                '    <td>17.00-22.00</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Babaszoba</td>\n' +
                '    <td>Díszaula</td>\n' +
                '    <td>17.00-22.00</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>  Általános izomerő vizsgálatok és egyensúlyi tesztek</td>\n' +
                '    <td>Díszaula</td>\n' +
                '    <td>17.00-22.00</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Gyógynövények az egészségturizmusban</td>\n' +
                '    <td>Díszaula</td>\n' +
                '    <td>17.00-22.00</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Együk magunkat egészségesre!</td>\n' +
                '    <td>Díszaula</td>\n' +
                '    <td>17.00-22.00</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Csontsűrűség mérése</td>\n' +
                '    <td>Díszaula</td>\n' +
                '    <td>17.00-22.00</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Csontsűrűség mérése</td>\n' +
                '    <td>Díszaula</td>\n' +
                '    <td>17.00-22.00</td>\n' +
                '  </tr>\n' +
                '  <tr>\n' +
                '    <td>Mit látsz a képen?</td>\n' +
                '    <td>Díszaula</td>\n' +
                '    <td>17.00-22.00</td>\n' +
                '  </tr>\n' +
                '</table></div>',
        }

        // shorthand func
        function byId(e) { return document.getElementById(e); }

        // takes a string that contains coords eg - "227,307,261,309, 339,354, 328,371, 240,331"
        // draws a line from each co-ord pair to the next - assumes starting point needs to be repeated as ending point.
        function drawPoly(coOrdStr) {
            var mCoords = coOrdStr.split(',');
            var i, n;
            n = mCoords.length;

            hdc.beginPath();
            hdc.moveTo(mCoords[0], mCoords[1]);
            for (i = 2; i < n; i += 2) {
                hdc.lineTo(mCoords[i], mCoords[i + 1]);
            }
            hdc.lineTo(mCoords[0], mCoords[1]);
            hdc.stroke();
        }

        function drawRect(coOrdStr) {
            var mCoords = coOrdStr.split(',');
            var top, left, bot, right;
            left = mCoords[0];
            top = mCoords[1];
            right = mCoords[2];
            bot = mCoords[3];
            hdc.strokeRect(left, top, right - left, bot - top);
        }

        function scaleX(x, min) {
            var width = $(window).width() / 4533;
            const w = x * width;
            return min ? (min > w ? min : w) : w;
        }

        function scaleY(y, min) {
            var height = $(window).height() / 5650;
            // return y * height;
            const w = y * height;
            return min ? (min > w ? min : w) : w;
        }

        function myHover(element, x ,y, width, height, place) {
            var hoveredElement = element;
            var coordStr = element.getAttribute('coords');
            var areaType = element.getAttribute('shape');
            $('.WTT').hide();
            const wtt = document.getElementsByClassName("WTT");  // Find the elements
            for(let i = 0; i < wtt.length; i++) {
                wtt[i].innerHTML=data[place];    // Change the content
            }

            $('.WTT').css({
                top: scaleY(y),
                left: scaleX(x),
                width: scaleX(width, 300),
                height: scaleY(height, 200)
            }).show()
            switch (areaType) {
                case 'polygon':
                case 'poly':
                    drawPoly(coordStr);
                    break;

                case 'rect':
                    drawRect(coordStr);
            }
        }

        function myLeave() {
            var canvas = byId('myCanvas');
            hdc.clearRect(0, 0, canvas.width, canvas.height);
        }

        function myInit() {
            // get the target image
            var img = byId('img-imgmap201293016112');

            var x, y, w, h;

            // get it's position and width+height
            x = img.offsetLeft;
            y = img.offsetTop;
            w = img.clientWidth;
            h = img.clientHeight;

            // move the canvas, so it's contained by the same parent as the image
            var imgParent = img.parentNode;
            var can = byId('myCanvas');
            imgParent.appendChild(can);

            // place the canvas in front of the image
            can.style.zIndex = 1;

            // position it over the image
            can.style.left = x + 'px';
            can.style.top = y + 'px';

            // make same size as the image
            can.setAttribute('width', w + 'px');
            can.setAttribute('height', h + 'px');

            // get it's context
            hdc = can.getContext('2d');

            // set the 'default' values for the colour/width of fill/stroke operations
            hdc.fillStyle = 'red';
            hdc.strokeStyle = 'red';
            hdc.lineWidth = 2;
            //$("div.popup").attr("style", "display:block");

        }
    </script>

    <style>
        .WTT {
            position: absolute;
            background: rgb(18,156,225);
            background: linear-gradient(90deg, rgba(18,156,225,0.836594012605042) 5%, rgba(18,142,225,0.7721682422969187) 29%, rgba(18,142,225,0.6461178221288515) 89%, rgba(0,204,255,0.2315519957983193) 100%);
            overflow: auto;
        }
        body {
            background-color: #f0f2f1;
        }

        canvas {
            pointer-events: none;
            /* make the canvas transparent to the mouse - needed since canvas is position infront of image */
            position: absolute;
        }

        .tooltip {
            position: relative;
            display: inline-block;
            border-bottom: 1px dotted black;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 120px;
            background-color: black;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 0;
            /* Position the tooltip */
            position: absolute;
            z-index: 1;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
        }

        .imgmap_css_container {
            position: relative;
        }
    </style>

    <title></title>
</head>

<body onload='myInit()'>



    <canvas id='myCanvas'></canvas>

    <center>
        <img src="joesvg.svg" width="100%" usemap='#imgmap_css_container_imgmap201293016112'
            class='imgmap_css_container' alt='imgmap201293016112' id='img-imgmap201293016112'>

        <map name="imgmap_css_container_imgmap201293016112">

            <area onmouseover='myHover(this, 1296, 2000, 1000, 600, "Diszaula");' onmouseout='myLeave();' target="" alt="asdasd" title="" href="#"
                class="imgmap201293016112-area" id="imgmap201293016112-area-0"
                coords="1296,1365,1538,1365,1536,1469,1294,1473" shape="poly">

            <area onmouseover='myHover(this, 2000, 1000, 1000, 600, "A/3");' onmouseout='myLeave();' target="" alt="asdasd" title="" href="#"
                class="imgmap201293016112-area" id="imgmap201293016112-area-1" coords="1887,1052,1943,1012,1959,1036,2051,1036,2059,1092,2143,1148,2183,1124,2235,1076,2235,1048,2348,1036,2372,1072,2372,1136,2235,1205,2187,1245"
                shape="poly">

            <area onmouseover='myHover(this, 1400, 2400, 1000, 600, "A/4");' onmouseout='myLeave();' target="" alt="asdasd" title="" href="#"
                class="imgmap201293016112-area" id="imgmap201293016112-area-2" coords="1881,3514,2410,3994"
                shape="rect">

        </map>
    </center>

    <div class="tooltip">Hover over me
        <span class="tooltiptext">Tooltip text</span>
    </div>

    <div id="tooltip">
        asdqwe123
    </div>
    <div class="WTT">
        <span>Tooltip text</span>
    </div>
    <div id="tt">
        <span class="tooltiptext">Tooltip textHASJDGHJSADGJ</span>
    </div>
    <div id="LTT" class="LTT">
        tooltipLin
    </div>
    <div id="MTT" class="MTT">
        tooltipMac
    </div>

    <script type="text/javascript" src="./imageMapResizer.min.js"></script>
    <script type="text/javascript">

        $('map').imageMapResize();

    </script>

    <script>
        var tappedElement;
        var actElement;
        $('.WTT').css({
            position: 'absolute'
        }).hide()
        $('area').each(function (i) {
            // $('area').eq(i).bind('mouseenter', function (e) {
            //     // console.log($('area').eq(i)[0].position())
            //     console.log($('#imgmap201293016112-area-0').position())
            //     if (!actElement) {
            //         actElement = $('area').eq(i);
            //         $('.WTT').eq(i).css({
            //             top: e.pageY,
            //             left: e.pageX
            //         }).show()
            //     }
            //
            // })
            //
            // $('area').eq(i).tap(function (e) {
            //     tappedElement = $('area').eq(i);
            //     const handler = () => {
            //         $('.WTT,.LTT,.MTT').hide()
            //     };
            //     $(tappedElement).bind('tap', handler);
            //     console.log(e)
            //     $('.WTT,.LTT,.MTT').eq(i).css({
            //         top: e.pageY,
            //         left: e.pageX
            //     }).show()
            // })
            //
            //
            // $('area').eq(i).bind('mouseleave', function (e) {
            //     // actElement.hide();
            //     actElement = null;
            //     $('.WTT').hide()
            // })
        })

        /*$('.WTT,.LTT,.MTT').css({
           position: 'absolute'
       }).hide()
       $('area').each(function (i) {
           $('area').eq(i).bind('mouseover', function (e) {
               $('.WTT,.LTT,.MTT').eq(i).css({
                   top: e.pageY,
                   left: e.pageX
               }).show()
           })

           $('area').eq(i).tap(function (e) {
               console.log(e)
               $('.WTT,.LTT,.MTT').eq(i).css({
                   top: e.pageY,
                   left: e.pageX
               }).show()
           })


           $('area').eq(i).bind('mouseout', function () {
               $('.WTT,.LTT,.MTT').stop().slideToggle();
           })
       })
   */
    </script>

</body>

</html>
